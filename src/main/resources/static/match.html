<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‰§é‡ - å¿«é€ŸåŒ¹é…</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Microsoft Yahei", sans-serif; }
        body { width: 100vw; height: 100vh; background: url("images/bg.jpg") no-repeat center center; background-size: cover; display: flex; padding: 20px; overflow: hidden; }

        /* ================= ä¾§è¾¹æ  ================= */
        .sidebar { width: 280px; height: 100%; background: linear-gradient(180deg, rgba(15,26,58,0.9), rgba(26,42,90,0.9)); border-radius: 20px; padding: 40px 20px; display: flex; flex-direction: column; position: relative; backdrop-filter: blur(10px); }
        .sidebar-logo { text-align: center; margin-bottom: 50px; }
        .sidebar-logo h2 { color: #fff; font-size: 42px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .sidebar-logo .star { width: 25px; height: 35px; background: #ff6600; clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%); }
        .menu-list { flex: 1; display: flex; flex-direction: column; gap: 15px; }
        .menu-item { width: 100%; height: 60px; background: transparent; border: none; border-radius: 12px; color: #fff; font-size: 18px; display: flex; align-items: center; padding: 0 20px; gap: 15px; cursor: pointer; transition: all 0.3s; opacity: 0.7; }
        .menu-item:hover { opacity: 1; background: rgba(255,255,255,0.1); }
        .logout-btn { width: 100%; height: 50px; background: transparent; border: none; color: #fff; font-size: 16px; cursor: pointer; transition: all 0.3s; text-align: left; padding-left: 20px; opacity: 0.7; }
        .logout-btn:hover { opacity: 1; color: #ff3300; }

        /* ================= ä¸»å†…å®¹åŒº ================= */
        .main-content { flex: 1; height: 100%; background: rgba(20, 25, 40, 0.85); backdrop-filter: blur(15px); border-radius: 20px; margin-left: 20px; padding: 40px; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; color: #fff; border: 1px solid rgba(255,255,255,0.1); }
        .back-btn { position: absolute; top: 30px; left: 40px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 16px; color: #fff; transition: 0.3s; }
        .back-btn:hover { background: #ff6600; border-color: #ff6600; }

        /* åŒ¹é…æ¡ä»¶åå¥½è®¾ç½® */
        .preferences { display: flex; gap: 20px; background: rgba(0,0,0,0.3); padding: 20px 40px; border-radius: 15px; border: 1px solid rgba(255,255,255,0.1); margin-bottom: 40px; }
        .pref-item select { padding: 10px 15px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); outline: none; font-size: 15px; background: rgba(255,255,255,0.1); color: #fff; cursor: pointer; }
        .pref-item select option { background: #1a2a5a; color: #fff; }

        /* åŒ¹é…ç­‰å¾…åŒº UI */
        .match-waiting-area { display: flex; flex-direction: column; align-items: center; transition: opacity 0.3s; }
        .timer-display { font-size: 48px; font-weight: bold; color: #ff9900; margin-bottom: 20px; font-family: monospace; text-shadow: 0 0 15px rgba(255, 153, 0, 0.5); }
        .match-radar-container { position: relative; width: 250px; height: 250px; display: flex; align-items: center; justify-content: center; margin-bottom: 30px; }
        .radar-btn { width: 120px; height: 120px; border-radius: 50%; background: linear-gradient(135deg, #ff6600, #ff3300); color: #fff; font-size: 22px; font-weight: bold; border: none; cursor: pointer; position: relative; z-index: 10; box-shadow: 0 0 30px rgba(255, 102, 0, 0.6); transition: transform 0.2s; }
        .radar-btn:hover { transform: scale(1.05); }

        .ripple { position: absolute; width: 120px; height: 120px; border-radius: 50%; border: 2px solid #ff6600; z-index: 1; opacity: 0; }
        .ripple.active { animation: rippleAnim 2s infinite cubic-bezier(0.1, 0.5, 0.8, 1); }
        .ripple:nth-child(2) { animation-delay: 0.6s; }
        .ripple:nth-child(3) { animation-delay: 1.2s; }
        @keyframes rippleAnim { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(3.5); opacity: 0; } }
        .status-text { font-size: 18px; color: #aaa; letter-spacing: 1px; text-align: center;}

        /* ================= åŒ¹é…æˆåŠŸç»“æœå¡ç‰‡ ================= */
        .match-result-card { display: none; width: 600px; background: rgba(30, 38, 56, 0.95); border: 1px solid #445; border-radius: 20px; padding: 30px; box-shadow: 0 15px 35px rgba(0,0,0,0.5); animation: slideUp 0.5s ease; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        .result-header { text-align: center; margin-bottom: 20px; color: #28a745; font-size: 24px; font-weight: bold; text-shadow: 0 0 10px rgba(40,167,69,0.4); }
        .script-info { display: flex; gap: 20px; margin-bottom: 25px; }
        .script-cover { width: 140px; height: 190px; border-radius: 10px; background: #333; object-fit: cover; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        .script-details { flex: 1; display: flex; flex-direction: column; justify-content: space-between; }
        .script-title { font-size: 26px; font-weight: bold; color: #fff; margin-bottom: 10px; }
        .tags { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px; }
        .tag { background: rgba(255,102,0,0.2); color: #ff9900; padding: 4px 10px; border-radius: 6px; font-size: 13px; border: 1px solid rgba(255,102,0,0.3); }
        .info-row { font-size: 14px; color: #ccc; margin-bottom: 5px; display: flex; align-items: center; gap: 8px; }
        .stars { color: #ffcc00; font-size: 14px; }
        .script-desc { font-size: 14px; color: #aaa; line-height: 1.6; background: rgba(0,0,0,0.2); padding: 15px; border-radius: 10px; margin-bottom: 25px; max-height: 100px; overflow-y: auto; }

        .action-btns { display: flex; gap: 20px; }
        .btn-join { flex: 1; padding: 15px; background: linear-gradient(90deg, #ff6600, #ff3300); border: none; border-radius: 10px; color: #fff; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-join:hover { box-shadow: 0 0 20px rgba(255,102,0,0.5); transform: translateY(-2px); }
        .btn-rematch { flex: 1; padding: 15px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 10px; color: #fff; font-size: 18px; cursor: pointer; transition: 0.3s; }
        .btn-rematch:hover { background: rgba(255,255,255,0.2); }
    </style>
</head>
<body>
<div class="sidebar">
    <div class="sidebar-logo"><h2><span class="star"></span>å‰§é‡</h2></div>
    <div class="menu-list">
        <button class="menu-item" onclick="goToPage('index.html')"><span>ğŸ </span><span>é¦–é¡µ</span></button>
        <button class="menu-item" onclick="goToPage('profile.html')"><span>ğŸ‘¤</span><span>ä¸ªäººä¿¡æ¯</span></button>
        <button class="menu-item" onclick="goToPage('chat.html')"><span>ğŸ’¬</span><span>å¥½å‹ç§ä¿¡</span></button>
    </div>
    <button class="logout-btn" id="logoutBtn">é€€å‡ºç™»å½•</button>
</div>

<div class="main-content">
    <button class="back-btn" onclick="goToPage('index.html')">â† è¿”å›é¦–é¡µ</button>

    <div class="preferences" id="filterArea">
        <div class="pref-item">
            <select id="scriptType">
                <option value="all">é¢˜æ (ä¸é™)</option>
                <option value="æ¨ç†">ç¡¬æ ¸æ¨ç†</option>
                <option value="æƒ…æ„Ÿ">æ²‰æµ¸æƒ…æ„Ÿ</option>
                <option value="ææ€–">å¾®ææƒŠæ‚š</option>
                <option value="æ¬¢ä¹">æ²™é›•æ¬¢ä¹</option>
            </select>
        </div>
        <div class="pref-item">
            <select id="playerCount">
                <option value="all">äººæ•° (ä¸é™)</option>
                <option value="5">5äººæœ¬</option>
                <option value="6">6äººæœ¬</option>
                <option value="7">7äººæœ¬</option>
            </select>
        </div>
        <div class="pref-item">
            <select id="scriptDiff">
                <option value="all">éš¾åº¦ (ä¸é™)</option>
                <option value="1">æ–°æ‰‹ (1-2æ˜Ÿ)</option>
                <option value="3">è¿›é˜¶ (3-4æ˜Ÿ)</option>
                <option value="5">çƒ§è„‘ (5æ˜Ÿ)</option>
            </select>
        </div>
    </div>

    <div class="match-waiting-area" id="waitingArea">
        <div class="timer-display" id="timer">00:00</div>
        <div class="match-radar-container">
            <div class="ripple" id="r1"></div>
            <div class="ripple" id="r2"></div>
            <div class="ripple" id="r3"></div>
            <button class="radar-btn" id="matchBtn">å¼€å§‹åŒ¹é…</button>
        </div>
        <div class="status-text" id="statusText">é€‰æ‹©ä¸Šæ–¹æ¡ä»¶<br>ç‚¹å‡»æŒ‰é’®å³åˆ»å¯»æ‰¾é»˜å¥‘è½¦é˜Ÿ</div>
    </div>

    <div class="match-result-card" id="resultCard">
        <div class="result-header">âœ¨ åŒ¹é…æˆåŠŸï¼Œå·²ä¸ºæ‚¨é”å®šè½¦é˜Ÿ âœ¨</div>
        <div class="script-info">
            <div class="script-cover" id="resCover" style="background-color: #444;"></div>
            <div class="script-details">
                <div>
                    <div class="script-title" id="resTitle">ã€ŠåŠ è½½ä¸­...ã€‹</div>
                    <div class="tags" id="resTags">
                    </div>
                </div>
                <div>
                    <div class="info-row">ğŸ‘¥ æˆ¿é—´äººæ•°ï¼š<strong style="color:#fff;" id="resWait">5/6 (ç¼º1äºº)</strong></div>
                    <div class="info-row">ğŸš» è§’è‰²é…ç½®ï¼š<span id="resConfig">åŠ è½½ä¸­</span></div>
                    <div class="info-row">ğŸ”¥ å‰§æœ¬éš¾åº¦ï¼š<span class="stars" id="resStars">â˜…â˜…â˜…â˜†â˜†</span></div>
                </div>
            </div>
        </div>
        <div class="script-desc" id="resDesc">åŠ è½½ä¸­...</div>
        <div class="action-btns">
            <button class="btn-rematch" onclick="rematch()">ä¸æ„Ÿå…´è¶£ï¼Œé‡æ–°åŒ¹é…</button>
            <button class="btn-join" onclick="joinRoom()">ç¡®è®¤åŠ å…¥æˆ¿é—´</button>
        </div>
    </div>
</div>

<script>
    function goToPage(pageUrl) {
        const username = localStorage.getItem('loginUsername') || '';
        window.location.href = `${pageUrl}?username=${encodeURIComponent(username)}`;
    }

    // ================= æ¨¡æ‹Ÿå‰§æœ¬æ•°æ®åº“ =================
    // åŒ…å«ä¸åŒç±»å‹ã€äººæ•°å’Œéš¾åº¦çš„å‰§æœ¬ï¼Œç”¨äºç­›é€‰æµ‹è¯•
    const mockScripts = [
        { title: "å­¤å²›æƒŠé­‚", type: "æ¨ç†", count: "6", diff: "5", config: "3ç”·3å¥³", stars: "â˜…â˜…â˜…â˜…â˜…", desc: "ä½ ä»¬åœ¨æµ·ä¸Šé­é‡é£æš´ï¼Œæµè½åˆ°è¿™åº§ä¸ä¸–éš”ç»çš„å­¤å²›ã€‚å½“ç¬¬ä¸€å…·å°¸ä½“å‡ºç°æ—¶ï¼Œå¤§å®¶éƒ½æ˜ç™½ï¼Œå‡¶æ‰‹å°±åœ¨ä½ ä»¬ä¹‹ä¸­...", tags: ["ç¡¬æ ¸", "å¯†å®¤"], coverBg: "#444" },
        { title: "é’å±±å…¥äº‘é—´", type: "æƒ…æ„Ÿ", count: "6", diff: "3", config: "3ç”·3å¥³", stars: "â˜…â˜…â˜…â˜†â˜†", desc: "å¤©ç¦§äºŒåä¸‰å¹´ï¼Œå¤§æ¥šçš‡åŸå†…é£äº‘æš—æ¶Œã€‚ä¸€é¦–ç»å‘½è¯—ï¼Œç‰µæ‰¯å‡ºåå¹´å‰çš„æ—§æ¡ˆã€‚è°æ˜¯æ‰§æ£‹è€…ï¼Œè°åˆæ˜¯å±€ä¸­äººï¼Ÿ", tags: ["å¤é£", "æƒ…æ„Ÿ", "æ¼”ç»"], coverBg: "#335" },
        { title: "æ‹†è¿æš´å‘æˆ·", type: "æ¬¢ä¹", count: "7", diff: "1", config: "4ç”·3å¥³", stars: "â˜…â˜…â˜†â˜†â˜†", desc: "è€åŸåŠç»ˆäºè¦æ‹†è¿äº†ï¼ä¸ºäº†äº‰å¤ºå·¨é¢æ‹†è¿æ¬¾ï¼Œè€ç‹å®¶è¿™ä¸ƒå£äººå¯è°“æ˜¯å…«ä»™è¿‡æµ·å„æ˜¾ç¥é€šï¼Œçˆ†ç¬‘äº’æ’•å³å°†å¼€å§‹ï¼", tags: ["æ¬¢ä¹", "æœºåˆ¶", "æ’•é€¼"], coverBg: "#533" },
        { title: "å±±æ‘è€å°¸", type: "ææ€–", count: "5", diff: "3", config: "2ç”·3å¥³", stars: "â˜…â˜…â˜…â˜…â˜†", desc: "ååƒ»çš„å±±æ‘ï¼Œè¯¡å¼‚çš„ç«¥è°£ã€‚å¬è¯´åå±±çš„ç ´åº™é‡Œï¼Œæ¯åˆ°åŠå¤œå°±ä¼šä¼ å‡ºå¥³äººçš„å“­å£°ã€‚ä½ ä»¬ä½œä¸ºæ¢é™©ä¸»æ’­ï¼Œå†³å®šä¸€æ¢ç©¶ç«Ÿ...", tags: ["ææ€–", "æ°‘ä¿—", "å˜æ ¼"], coverBg: "#111" },
        { title: "ä»£ç æ€æœº", type: "æ¬¢ä¹", count: "5", diff: "3", config: "5ç”·", stars: "â˜…â˜…â˜…â˜…â˜†", desc: "è·ç¦»äº§å“ä¸Šçº¿ä»…å‰©å‡ å°æ—¶ï¼Œæ ¸å¿ƒæœåŠ¡å™¨æƒ¨é­ rm -rf /*ï¼å¤§é—¨åé”ï¼Œ5åäº’è”ç½‘æ‰“å·¥äººäº’è¸©ã€‚æ˜¯è°åˆ åº“è·‘è·¯ï¼Ÿ", tags: ["ç¨‹åºå‘˜", "èŒåœº", "æ¬¢ä¹"], coverBg: "#2a1b4a" },
        { title: "æš—å¤œé’Ÿå£°", type: "æ¨ç†", count: "7", diff: "5", config: "4ç”·3å¥³", stars: "â˜…â˜…â˜…â˜…â˜…", desc: "æ¬§æ´²ä¸­ä¸–çºªå¤å ¡ï¼ŒåäºŒç‚¹çš„é’Ÿå£°æ•²å“ï¼Œä¼¯çˆµæ­»åœ¨äº†å¯†å®¤ä¸­ã€‚å®Œç¾çš„çŠ¯ç½ªæ‰‹æ³•ï¼Œè¿™ç©¶ç«Ÿæ˜¯å¹½çµä½œç¥Ÿè¿˜æ˜¯äººä¸ºï¼Ÿ", tags: ["æ¬§å¼", "ç¡¬æ ¸", "è¿˜åŸ"], coverBg: "#2d2d2d" }
    ];

    let isMatching = false;
    let matchTimeout = null;
    let timerInterval = null;
    let seconds = 0;
    let currentMatchedScript = null; // å½“å‰åŒ¹é…åˆ°çš„å‰§æœ¬

    const matchBtn = document.getElementById('matchBtn');
    const ripples = document.querySelectorAll('.ripple');
    const statusText = document.getElementById('statusText');
    const timerDisplay = document.getElementById('timer');
    const waitingArea = document.getElementById('waitingArea');
    const resultCard = document.getElementById('resultCard');
    const filterArea = document.getElementById('filterArea');

    function formatTime(sec) {
        const m = Math.floor(sec / 60).toString().padStart(2, '0');
        const s = (sec % 60).toString().padStart(2, '0');
        return `${m}:${s}`;
    }

    function updateTimer() {
        seconds++;
        timerDisplay.innerText = formatTime(seconds);
    }

    // å¼€å§‹åŒ¹é…é€»è¾‘
    function startMatching() {
        // 1. è·å–ç­›é€‰æ¡ä»¶
        const selectedType = document.getElementById('scriptType').value;
        const selectedCount = document.getElementById('playerCount').value;
        const selectedDiff = document.getElementById('scriptDiff').value;

        // 2. æ ¹æ®æ¡ä»¶è¿‡æ»¤å‰§æœ¬åº“
        let filteredScripts = mockScripts.filter(s => {
            let matchType = (selectedType === 'all' || s.type === selectedType);
            let matchCount = (selectedCount === 'all' || s.count === selectedCount);
            // éš¾åº¦ç­›é€‰é€»è¾‘ï¼š1=æ–°æ‰‹(1-2æ˜Ÿ), 3=è¿›é˜¶(3-4æ˜Ÿ), 5=çƒ§è„‘(5æ˜Ÿ)
            let matchDiff = true;
            if (selectedDiff === '1') matchDiff = (s.diff <= 2);
            if (selectedDiff === '3') matchDiff = (s.diff == 3 || s.diff == 4);
            if (selectedDiff === '5') matchDiff = (s.diff == 5);
            if (selectedDiff === 'all') matchDiff = true;

            return matchType && matchCount && matchDiff;
        });

        // 3. UI çŠ¶æ€åˆ‡æ¢
        isMatching = true;
        seconds = 0;
        timerDisplay.innerText = "00:00";
        matchBtn.innerText = 'å–æ¶ˆåŒ¹é…';
        matchBtn.style.background = 'linear-gradient(135deg, #ff3333, #cc0000)';
        ripples.forEach(r => r.classList.add('active'));
        filterArea.style.opacity = '0.5'; // åŒ¹é…ä¸­ä¸å¯æ”¹æ¡ä»¶æç¤º
        filterArea.style.pointerEvents = 'none';

        if (filteredScripts.length === 0) {
            statusText.innerHTML = 'æ­£åœ¨å…¨ç½‘æœç´¢åˆé€‚è½¦é˜Ÿ...<br><span style="color:#ff3333; font-size:14px;">(å½“å‰æ¡ä»¶è¾ƒè‹›åˆ»ï¼Œå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´)</span>';
        } else {
            statusText.innerHTML = 'æ­£åœ¨å…¨ç½‘æœç´¢åˆé€‚è½¦é˜Ÿ...';
        }
        statusText.style.color = '#ff9900';
        timerInterval = setInterval(updateTimer, 1000);

        // 4. æ¨¡æ‹ŸåŒ¹é…ç­‰å¾…æ—¶é—´ (3-5ç§’)
        const randomWaitTime = Math.floor(Math.random() * 3000) + 2000;

        matchTimeout = setTimeout(() => {
            if (filteredScripts.length === 0) {
                // æ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æœ¬
                stopMatching();
                alert("ğŸ˜­ å½“å‰ç­›é€‰æ¡ä»¶ä¸‹æœªæ‰¾åˆ°æ­£åœ¨æ‹›å‹Ÿçš„è½¦é˜Ÿï¼\nè¯·æ”¾å®½ï¼ˆé¢˜æ/äººæ•°/éš¾åº¦ï¼‰æ¡ä»¶åé‡æ–°åŒ¹é…ã€‚");
            } else {
                // éšæœºæŠ½å–ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æœ¬
                currentMatchedScript = filteredScripts[Math.floor(Math.random() * filteredScripts.length)];
                showMatchResult(currentMatchedScript);
            }
        }, randomWaitTime);
    }

    function stopMatching() {
        isMatching = false;
        clearInterval(timerInterval);
        clearTimeout(matchTimeout);
        matchBtn.innerText = 'å¼€å§‹åŒ¹é…';
        matchBtn.style.background = 'linear-gradient(135deg, #ff6600, #ff3300)';
        ripples.forEach(r => r.classList.remove('active'));
        statusText.innerHTML = 'é€‰æ‹©ä¸Šæ–¹æ¡ä»¶<br>ç‚¹å‡»æŒ‰é’®å³åˆ»å¯»æ‰¾é»˜å¥‘è½¦é˜Ÿ';
        statusText.style.color = '#aaa';

        filterArea.style.opacity = '1';
        filterArea.style.pointerEvents = 'auto';
    }

    // å±•ç¤ºåŒ¹é…åˆ°çš„å‰§æœ¬è¯¦æƒ…
    function showMatchResult(script) {
        stopMatching();

        // åŠ¨æ€å¡«å……å¡ç‰‡æ•°æ®
        document.getElementById('resTitle').innerText = `ã€Š${script.title}ã€‹`;
        document.getElementById('resConfig').innerText = script.config;
        document.getElementById('resStars').innerText = script.stars;
        document.getElementById('resDesc').innerText = script.desc;
        document.getElementById('resCover').style.background = `url('https://via.placeholder.com/140x190/${script.coverBg.replace('#','')}/fff?text=Cover') center/cover, ${script.coverBg}`;

        // æ¨¡æ‹Ÿå½“å‰æˆ¿é—´ç¼ºå‡ äºº (éšæœºç¼º1-2äºº)
        const missing = Math.floor(Math.random() * 2) + 1;
        const current = parseInt(script.count) - missing;
        document.getElementById('resWait').innerText = `${current}/${script.count} (ç¼º${missing}äºº)`;

        // åŠ¨æ€æ¸²æŸ“æ ‡ç­¾
        let tagsHtml = '';
        script.tags.forEach((tag, index) => {
            // ç»™ç¬¬ä¸€ä¸ªæ ‡ç­¾æ¢ä¸ªé¢œè‰²
            const colorClass = index === 1 ? 'tag blue' : 'tag';
            tagsHtml += `<span class="${colorClass}">${tag}</span>`;
        });
        document.getElementById('resTags').innerHTML = tagsHtml;

        // åˆ‡æ¢æ˜¾ç¤ºè§†å›¾
        waitingArea.style.display = 'none';
        filterArea.style.display = 'none';
        resultCard.style.display = 'block';
    }

    // é‡æ–°åŒ¹é…
    function rematch() {
        resultCard.style.display = 'none';
        waitingArea.style.display = 'flex';
        filterArea.style.display = 'flex';
        startMatching();
    }

    // ç¡®è®¤åŠ å…¥æˆ¿é—´
    function joinRoom() {
        if(!currentMatchedScript) return;

        const username = localStorage.getItem('loginUsername') || '';
        // å¸¦ç€å‰§æœ¬åå’Œéšæœºç”Ÿæˆçš„æˆ¿é—´åè·³è½¬åˆ°æ¸¸æˆå¤§å…
        const randomRoomName = `${currentMatchedScript.title} ${Math.floor(Math.random()*100)}å·ä¸“è½¦`;
        const targetUrl = `game-room.html?username=${encodeURIComponent(username)}&script=${encodeURIComponent(currentMatchedScript.title)}&roomName=${encodeURIComponent(randomRoomName)}`;

        alert("âœ¨ åŒ¹é…æˆåŠŸï¼å³å°†å¸¦æ‚¨è¿›å…¥æ¸¸æˆæˆ¿é—´...");
        window.location.href = targetUrl;
    }

    // æŒ‰é’®äº‹ä»¶ç»‘å®š
    matchBtn.addEventListener('click', function() {
        if (!isMatching) { startMatching(); }
        else { stopMatching(); }
    });

    document.getElementById('logoutBtn').addEventListener('click', function() {
        localStorage.clear(); window.location.href = 'login.html';
    });
</script>
</body>
</html>