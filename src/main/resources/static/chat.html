<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å‰§é‡ - å¥½å‹ç§ä¿¡</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Microsoft Yahei", sans-serif; }
        body { width: 100vw; height: 100vh; background: url("images/bg.jpg") no-repeat center center; background-size: cover; display: flex; padding: 20px; overflow: hidden; }

        /* ================= ä¾§è¾¹æ  ================= */
        .sidebar { width: 280px; height: 100%; background: linear-gradient(180deg, rgba(15,26,58,0.9), rgba(26,42,90,0.9)); border-radius: 20px; padding: 40px 20px; display: flex; flex-direction: column; backdrop-filter: blur(10px); z-index: 10;}
        .sidebar-logo { text-align: center; margin-bottom: 50px; }
        .sidebar-logo h2 { color: #fff; font-size: 42px; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .sidebar-logo .star { width: 25px; height: 35px; background: #ff6600; clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%); }
        .menu-list { flex: 1; display: flex; flex-direction: column; gap: 15px; }
        .menu-item { width: 100%; height: 60px; background: transparent; border: none; border-radius: 12px; color: #fff; font-size: 18px; display: flex; align-items: center; padding: 0 20px; gap: 15px; cursor: pointer; transition: 0.3s; opacity: 0.7; }
        .menu-item:hover { opacity: 1; background: rgba(255,255,255,0.1); }
        .menu-item.active { background: linear-gradient(90deg, #ff6600, #ff3300); opacity: 1; box-shadow: 0 5px 15px rgba(255, 102, 0, 0.3); }

        /* ================= ä¸»å†…å®¹åŒº ================= */
        .main-content { flex: 1; height: 100%; background: rgba(18, 22, 33, 0.9); backdrop-filter: blur(15px); border-radius: 20px; margin-left: 20px; display: flex; overflow: hidden; border: 1px solid rgba(255,255,255,0.1); }

        /* å·¦ä¾§ï¼šå¥½å‹åˆ—è¡¨åŒº */
        .chat-sidebar { width: 320px; background: rgba(0,0,0,0.2); border-right: 1px solid rgba(255,255,255,0.05); display: flex; flex-direction: column; }
        .search-area { padding: 20px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .search-box { display: flex; align-items: center; background: rgba(255,255,255,0.05); border-radius: 12px; padding: 10px 15px; border: 1px solid rgba(255,255,255,0.1); }
        .search-box input { background: none; border: none; color: #fff; padding-left: 10px; outline: none; width: 100%; font-size: 14px; }

        .friend-list { flex: 1; overflow-y: auto; }
        /* éšè—æ»šåŠ¨æ¡ */
        .friend-list::-webkit-scrollbar { width: 6px; }
        .friend-list::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 3px; }

        .friend-item { display: flex; align-items: center; padding: 15px 20px; cursor: pointer; transition: 0.3s; border-bottom: 1px solid rgba(255,255,255,0.02); }
        .friend-item:hover { background: rgba(255,255,255,0.05); }
        .friend-item.active { background: rgba(255,102,0,0.1); border-left: 4px solid #ff6600; }

        .f-avatar { width: 45px; height: 45px; border-radius: 50%; background: #444; margin-right: 15px; position: relative; object-fit: cover; }
        .online-dot { position: absolute; bottom: 0; right: 0; width: 12px; height: 12px; background: #28a745; border: 2px solid #1a2035; border-radius: 50%; }
        .f-info { flex: 1; overflow: hidden; }
        .f-name-time { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        .f-name { color: #fff; font-size: 16px; font-weight: bold; }
        .f-time { color: #666; font-size: 12px; }
        .f-msg { color: #888; font-size: 13px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .unread-badge { background: #ff3333; color: #fff; font-size: 12px; padding: 2px 6px; border-radius: 10px; margin-left: 10px; }

        /* å³ä¾§ï¼šèŠå¤©çª—å£åŒº */
        .chat-window { flex: 1; display: flex; flex-direction: column; background: rgba(0,0,0,0.1); }
        .chat-header { padding: 20px 30px; border-bottom: 1px solid rgba(255,255,255,0.05); display: flex; justify-content: space-between; align-items: center; }
        .chat-title { color: #fff; font-size: 18px; font-weight: bold; display: flex; align-items: center; gap: 10px; }
        .chat-status { font-size: 12px; color: #28a745; font-weight: normal; }
        .chat-actions button { background: none; border: none; color: #aaa; font-size: 20px; cursor: pointer; margin-left: 15px; transition: 0.3s; }
        .chat-actions button:hover { color: #ff6600; }

        .chat-messages { flex: 1; padding: 30px; overflow-y: auto; display: flex; flex-direction: column; gap: 20px; }
        .chat-messages::-webkit-scrollbar { width: 6px; }
        .chat-messages::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 3px; }

        .msg-time { text-align: center; color: #666; font-size: 12px; margin: 10px 0; }

        .msg-wrapper { display: flex; max-width: 80%; }
        .msg-wrapper.received { align-self: flex-start; }
        .msg-wrapper.sent { align-self: flex-end; flex-direction: row-reverse; }

        .msg-avatar { width: 40px; height: 40px; border-radius: 50%; background: #555; margin: 0 15px; object-fit: cover; }
        .msg-bubble { padding: 12px 18px; border-radius: 15px; font-size: 15px; line-height: 1.5; word-break: break-all; }

        .received .msg-bubble { background: rgba(255,255,255,0.1); color: #ddd; border-top-left-radius: 2px; }
        .sent .msg-bubble { background: linear-gradient(135deg, #ff6600, #ff3300); color: #fff; border-top-right-radius: 2px; box-shadow: 0 5px 15px rgba(255,102,0,0.2); }

        /* èŠå¤©è¾“å…¥åŒº */
        .chat-input-area { padding: 20px 30px; border-top: 1px solid rgba(255,255,255,0.05); background: rgba(0,0,0,0.2); }
        .input-toolbar { display: flex; gap: 15px; margin-bottom: 15px; }
        .input-toolbar button { background: none; border: none; color: #888; font-size: 20px; cursor: pointer; transition: 0.3s; }
        .input-toolbar button:hover { color: #ff6600; }

        .input-box { display: flex; gap: 15px; align-items: flex-end; }
        .input-box textarea { flex: 1; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; color: #fff; padding: 15px; font-size: 15px; outline: none; resize: none; height: 80px; transition: 0.3s; }
        .input-box textarea:focus { border-color: rgba(255,102,0,0.5); background: rgba(255,255,255,0.08); }

        .send-btn { background: linear-gradient(90deg, #ff6600, #ff3300); color: #fff; border: none; border-radius: 12px; padding: 0 30px; height: 50px; font-size: 16px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-bottom: 15px; }
        .send-btn:hover { box-shadow: 0 5px 15px rgba(255,102,0,0.4); transform: translateY(-2px); }

    </style>
</head>
<body>
<div class="sidebar">
    <div class="sidebar-logo"><h2><span class="star"></span>å‰§é‡</h2></div>
    <div class="menu-list">
        <button class="menu-item" onclick="goToPage('index.html')"><span>ğŸ </span><span>é¦–é¡µ</span></button>
        <button class="menu-item" onclick="goToPage('profile.html')"><span>ğŸ‘¤</span><span>ä¸ªäººä¿¡æ¯</span></button>
        <button class="menu-item active" onclick="goToPage('chat.html')"><span>ğŸ’¬</span><span>å¥½å‹ç§ä¿¡</span></button>
    </div>
</div>

<div class="main-content">
    <div class="chat-sidebar">
        <div class="search-area">
            <div class="search-box">
                <span>ğŸ”</span>
                <input type="text" placeholder="æœç´¢è”ç³»äººæˆ–ç¾¤ç»„...">
            </div>
        </div>
        <div class="friend-list">
            <div class="friend-item active" onclick="switchChat('DM-ä¸ƒä¸ƒ', 'online')">
                <img src="images/friend1.jpg" class="f-avatar" onerror="this.src='images/avatar_1771915686380_60dfede0789e6e876c73b9d77b1b54c8.webp'"><div class="online-dot"></div>
                <div class="f-info">
                    <div class="f-name-time"><span class="f-name">DM-ä¸ƒä¸ƒ</span><span class="f-time">14:20</span></div>
                    <div class="f-msg">å‘¨å…­ä¸‹åˆ2ç‚¹çš„è½¦ï¼Œè¿˜ç¼ºä¸ªç”·ç”Ÿï¼Œæ¥å—ï¼Ÿ</div>
                </div>
                <div class="unread-badge">1</div>
            </div>

            <div class="friend-item" onclick="switchChat('ç¥ç§˜å‰§å‹_K', 'offline')">
                <img src="images/friend2.jpg" class="f-avatar" onerror="this.src='images/avatar_1771915686380_60dfede0789e6e876c73b9d77b1b54c8.webp'">
                <div class="f-info">
                    <div class="f-name-time"><span class="f-name">ç¥ç§˜å‰§å‹_K</span><span class="f-time">æ˜¨å¤©</span></div>
                    <div class="f-msg">ä¸Šæ¬¡é‚£ä¸ªæƒ…æ„Ÿæœ¬çœŸçš„ç»äº†ã€‚</div>
                </div>
            </div>

            <div class="friend-item" onclick="switchChat('æ¨ç†ç‹‚äºº', 'online')">
                <img src="images/friend3.jpg" class="f-avatar" onerror="this.src='images/avatar_1771915686380_60dfede0789e6e876c73b9d77b1b54c8.webp'"><div class="online-dot"></div>
                <div class="f-info">
                    <div class="f-name-time"><span class="f-name">æ¨ç†ç‹‚äºº</span><span class="f-time">æ˜ŸæœŸäºŒ</span></div>
                    <div class="f-msg">æˆ‘ç ´è§£äº†å‡¶æ‰‹çš„è¯¡è®¡ï¼</div>
                </div>
            </div>
        </div>
    </div>

    <div class="chat-window">
        <div class="chat-header">
            <div class="chat-title" id="chatTitle">
                DM-ä¸ƒä¸ƒ <span class="chat-status" id="chatStatus">â— åœ¨çº¿</span>
            </div>
            <div class="chat-actions">
                <button title="å‘èµ·è¯­éŸ³">ğŸ“</button>
                <button title="å¥½å‹è®¾ç½®">âš™ï¸</button>
            </div>
        </div>

        <div class="chat-messages" id="chatMessages">
            <div class="msg-time">æ˜¨å¤© 18:30</div>

            <div class="msg-wrapper received">
                <img src="images/friend1.jpg" class="msg-avatar" onerror="this.src='images/avatar_1771915686380_60dfede0789e6e876c73b9d77b1b54c8.webp'">
                <div class="msg-bubble">å“ˆå–½ï¼æœ€è¿‘æœ‰ä¸ªç¡¬æ ¸æœ¬éå¸¸é€‚åˆä½ ï¼Œè¦ä¸è¦ä¸Šè½¦ï¼Ÿ</div>
            </div>

            <div class="msg-wrapper sent">
                <img src="images/avatar_1771915686380_60dfede0789e6e876c73b9d77b1b54c8.webp" class="msg-avatar">
                <div class="msg-bubble">ä»€ä¹ˆæœ¬ï¼Ÿéš¾åº¦æ€ä¹ˆæ ·ï¼Ÿ</div>
            </div>

            <div class="msg-time">ä»Šå¤© 14:20</div>

            <div class="msg-wrapper received">
                <img src="images/friend1.jpg" class="msg-avatar" onerror="this.src='images/avatar_1771915686380_60dfede0789e6e876c73b9d77b1b54c8.webp'">
                <div class="msg-bubble">ã€Šå­¤å²›æƒŠé­‚ã€‹ï¼Œéš¾åº¦5é¢—æ˜Ÿï¼å‘¨å…­ä¸‹åˆ2ç‚¹çš„è½¦ï¼Œè¿˜ç¼ºä¸ªç”·ç”Ÿï¼Œæ¥å—ï¼Ÿ</div>
            </div>
        </div>

        <div class="chat-input-area">
            <div class="input-toolbar">
                <button title="è¡¨æƒ…">ğŸ˜€</button>
                <button title="å‘é€å›¾ç‰‡">ğŸ–¼ï¸</button>
                <button title="å‘é€å‰§æœ¬åç‰‡">ğŸ“š</button>
            </div>
            <div class="input-box">
                <textarea id="messageInput" placeholder="è¾“å…¥ä½ æƒ³è¯´çš„è¯... (æŒ‰ Enter å‘é€)"></textarea>
                <button class="send-btn" onclick="sendMessage()">å‘é€</button>
            </div>
        </div>
    </div>
</div>

<script>
    function goToPage(url) {
        const username = localStorage.getItem('loginUsername') || '';
        window.location.href = `${url}?username=${encodeURIComponent(username)}`;
    }

    // åˆ‡æ¢èŠå¤©å¥½å‹çš„æ¨¡æ‹Ÿäº¤äº’
    function switchChat(name, status) {
        // æ›´æ–°å·¦ä¾§é«˜äº®çŠ¶æ€
        const items = document.querySelectorAll('.friend-item');
        items.forEach(item => {
            item.classList.remove('active');
            // æ¸…é™¤çº¢ç‚¹ï¼ˆç®€å•æ¨¡æ‹Ÿå·²è¯»ï¼‰
            if(item.querySelector('.f-name').innerText === name) {
                item.classList.add('active');
                const badge = item.querySelector('.unread-badge');
                if(badge) badge.style.display = 'none';
            }
        });

        // æ›´æ–°å³ä¾§å¤´éƒ¨
        document.getElementById('chatTitle').innerHTML = `${name} <span class="chat-status" style="color:${status==='online'?'#28a745':'#888'}">â— ${status==='online'?'åœ¨çº¿':'ç¦»çº¿'}</span>`;

        // æ¸…ç©ºå³ä¾§æ¶ˆæ¯å¹¶æ·»åŠ å ä½æ¶ˆæ¯ï¼ˆåŠ å…¥äº†å®¹é”™å¤´åƒå¤„ç†ï¼‰
        const chatBox = document.getElementById('chatMessages');
        chatBox.innerHTML = `
            <div class="msg-time">åˆšåˆš</div>
            <div class="msg-wrapper received">
                <img src="images/friend_default.jpg" class="msg-avatar" onerror="this.src='images/avatar_1771915686380_60dfede0789e6e876c73b9d77b1b54c8.webp'">
                <div class="msg-bubble">è¿™æ˜¯ä¸ ${name} çš„èŠå¤©è®°å½•...</div>
            </div>
        `;
    }

    // å‘é€æ¶ˆæ¯
    function sendMessage() {
        const input = document.getElementById('messageInput');
        const text = input.value.trim();
        if(!text) return;

        const chatBox = document.getElementById('chatMessages');

        // æ·»åŠ æˆ‘å‘é€çš„æ¶ˆæ¯ï¼ˆä½¿ç”¨ä½ å·²ç»ä¸Šä¼ å¥½çš„å¤´åƒï¼‰
        const myMsgHtml = `
            <div class="msg-wrapper sent" style="opacity: 0; animation: fadeIn 0.3s forwards;">
                <img src="images/avatar_1771915686380_60dfede0789e6e876c73b9d77b1b54c8.webp" class="msg-avatar">
                <div class="msg-bubble">${text}</div>
            </div>
        `;
        chatBox.insertAdjacentHTML('beforeend', myMsgHtml);

        // æ¸…ç©ºè¾“å…¥æ¡†å¹¶æ»šåŠ¨åˆ°åº•éƒ¨
        input.value = '';
        chatBox.scrollTop = chatBox.scrollHeight;

        // ç®€å•çš„è‡ªåŠ¨å›å¤æ¨¡æ‹Ÿ
        setTimeout(() => {
            const replyHtml = `
                <div class="msg-wrapper received" style="opacity: 0; animation: fadeIn 0.3s forwards;">
                    <img src="images/friend1.jpg" class="msg-avatar" onerror="this.src='images/avatar_1771915686380_60dfede0789e6e876c73b9d77b1b54c8.webp'">
                    <div class="msg-bubble">æ”¶åˆ°ï¼(æ­¤ä¸ºç³»ç»Ÿè‡ªåŠ¨å›å¤æ¨¡æ‹Ÿ)</div>
                </div>
            `;
            chatBox.insertAdjacentHTML('beforeend', replyHtml);
            chatBox.scrollTop = chatBox.scrollHeight;
        }, 1000);
    }

    // ç›‘å¬å›è½¦é”®å‘é€æ¶ˆæ¯
    document.getElementById('messageInput').addEventListener('keypress', function(e) {
        if(e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault(); // é˜»æ­¢é»˜è®¤æ¢è¡Œ
            sendMessage();
        }
    });

    // æ³¨å…¥ç®€å•çš„æ·¡å…¥åŠ¨ç”»
    const style = document.createElement('style');
    style.innerHTML = `@keyframes fadeIn { to { opacity: 1; } }`;
    document.head.appendChild(style);
</script>
</body>
</html>